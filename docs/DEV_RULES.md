# DEV_RULES（開発ルール）

## 1. 命名規則

### 1.1 ファイル・ディレクトリ

- **コンポーネント**: PascalCase（例: `ProblemCard.tsx`）
- **フック**: camelCase + `use` プレフィックス（例: `useProgress.ts`）
- **ユーティリティ**: camelCase（例: `storage.ts`）
- **型定義**: PascalCase（例: `types.ts` 内の `interface Problem`）
- **定数**: UPPER_SNAKE_CASE（例: `MAX_ATTEMPTS`）

### 1.2 変数・関数

- **変数**: camelCase（例: `problemId`, `userProgress`）
- **関数**: camelCase（例: `getProgress()`, `saveAttempt()`）
- **コンポーネント**: PascalCase（例: `ProblemCard`）
- **型・インターフェース**: PascalCase（例: `Problem`, `UserProgress`）

### 1.3 CSSクラス

- Tailwind CSSを使用
- カスタムクラスは必要最小限に
- コンポーネント内で完結させる

## 2. コンポーネント設計

### 2.1 原則

- **単一責任の原則**: 1コンポーネントは1つの責務
- **再利用性**: 共通ロジックはコンポーネント化
- **Props型定義**: すべてのPropsに型を定義

### 2.2 コンポーネント構造

```typescript
// components/ui/Button.tsx
interface ButtonProps {
  label: string;
  onClick: () => void;
  variant?: 'primary' | 'secondary';
}

export const Button: React.FC<ButtonProps> = ({ label, onClick, variant = 'primary' }) => {
  return (
    <button onClick={onClick} className={...}>
      {label}
    </button>
  );
};
```

### 2.3 ディレクトリ構成

```
components/
├── ui/              # 汎用UIコンポーネント
│   ├── Button.tsx
│   └── Card.tsx
└── layout/          # レイアウトコンポーネント
    └── Header.tsx
```

## 3. 状態管理

### 3.1 基本方針

- **React state**: コンポーネント内の状態
- **localStorage**: 永続化が必要なデータ（進捗等）
- **Zustand**: 必要に応じて導入（MVPでは不要かも）

### 3.2 カスタムフック

- データ取得・保存ロジックはカスタムフックに分離
- 例: `useProgress()`, `useFavorites()`

## 4. 禁止事項

### 4.1 機能面

- **正答率を表示しない**
  - 進捗ページに正答率を表示してはいけない
  - 問題ページでも正答率を表示してはいけない

- **勝率を表示しない**
  - トレードの勝率を表示してはいけない

- **煽り指標を表示しない**
  - 「もっと頑張ろう」「正答率が低いです」等のメッセージは禁止
  - 学習者を煽るような表現は一切使わない

- **動画を埋め込まない**
  - MVPでは動画ホスティングは非対応

### 4.2 コード面

- **any型の使用禁止**
  - すべての型を明示的に定義
  - やむを得ない場合は `unknown` を使用

- **console.logの残し禁止**
  - 本番コードに `console.log` を残さない
  - デバッグ時は削除する

- **未使用のimport禁止**
  - 未使用のimportは削除する

## 5. UI/UXの原則

### 5.1 基本方針

- **スマホ縦持ち前提**
  - デザインはスマホ縦持ちを前提とする
  - タブレット・PCでも見れるが、最適化はスマホ優先

- **タップ操作だけで完結**
  - スワイプや複雑なジェスチャーは不要
  - すべての操作をタップで完結させる

- **最短導線**
  - 学習開始・問題開始までのクリック数を最小化
  - 不要な画面遷移を避ける

- **繰り返し学習を促す**
  - 「次へ」ボタンを目立たせる
  - 問題を解いた後はすぐに次の問題へ進める

### 5.2 表示する指標

- **反復量（回数）**
  - 問題を解いた回数
  - 学習日数

- **継続（学習日数）**
  - 連続学習日数（任意）
  - 総学習日数

### 5.3 表示しない指標

- 正答率
- 勝率
- 煽り指標（「もっと頑張ろう」等）

## 6. PR粒度

### 6.1 1PR = 1機能

- 1つのPRは1つの機能実装に絞る
- 複数の機能を同時に実装しない

### 6.2 PRの構成

- **タイトル**: 機能名を簡潔に（例: `feat: 問題出題機能を実装`）
- **説明**: 実装内容、変更点、確認方法
- **関連Issue**: 関連するIssue番号

## 7. コミット規約

### 7.1 コミットメッセージ形式

```
<type>: <subject>

<body>
```

### 7.2 タイプ

- `feat`: 新機能
- `fix`: バグ修正
- `docs`: ドキュメント
- `style`: コードスタイル（フォーマット等）
- `refactor`: リファクタリング
- `test`: テスト
- `chore`: その他（ビルド設定等）

### 7.3 例

```
feat: 問題出題機能を実装

- 5ステップの回答フローを実装
- 解説表示機能を追加
- 進捗保存機能を実装
```

## 8. テスト

### 8.1 MVPでのテスト方針

- **ユニットテスト**: 余力があれば実装
- **E2Eテスト**: MVPでは任意
- **手動テスト**: 必須（主要機能は手動で確認）

### 8.2 テスト対象

- 進捗保存・読み込み
- お気に入り機能
- 問題出題フロー

## 9. パフォーマンス

### 9.1 最適化

- 画像の最適化（WebP形式推奨）
- コード分割（Next.jsの自動分割を活用）
- 不要な再レンダリングを避ける

### 9.2 バンドルサイズ

- チャンクサイズが500KBを超える場合は警告
- 必要に応じて動的インポートを使用

## 10. アクセシビリティ

### 10.1 基本対応

- セマンティックHTMLを使用
- キーボード操作に対応（可能な範囲で）
- コントラスト比を確保

