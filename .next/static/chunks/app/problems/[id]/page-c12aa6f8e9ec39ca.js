(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[877],{8818:function(e,t,n){Promise.resolve().then(n.bind(n,8504))},8504:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return a}});var s=n(7437),l=n(2265),i=n(7648),o=n(9376),r=n(7795);function c(e){var t,n;let{data:l,width:i=400,height:o=250}=e,r=l||{type:"trend",line:{price:60,touches:3},priceAction:[{high:70,low:50,open:55,close:65},{high:75,low:60,open:65,close:70},{high:80,low:65,open:70,close:75},{high:75,low:60,open:75,close:65},{high:70,low:55,open:65,close:60},{high:65,low:50,open:60,close:55},{high:60,low:45,open:55,close:50},{high:55,low:40,open:50,close:45}]},c=i-80,a=o-80,d=r.priceAction||[],h=d.flatMap(e=>[e.high,e.low,e.open,e.close]),u=Math.min(...h,(null===(t=r.line)||void 0===t?void 0:t.price)||0),x=Math.max(...h,(null===(n=r.line)||void 0===n?void 0:n.price)||100)-u||1,m=e=>40+a-(e-u)/x*a,g=c/(d.length||1),p=e=>40+e*g+g/2;return(0,s.jsxs)("div",{className:"w-full bg-white rounded-lg border border-gray-200 p-4",children:[(0,s.jsxs)("svg",{width:i,height:o,className:"w-full h-auto",children:[(0,s.jsx)("defs",{children:(0,s.jsx)("pattern",{id:"grid",width:g,height:a/4,patternUnits:"userSpaceOnUse",children:(0,s.jsx)("path",{d:"M ".concat(g," 0 L 0 0 0 ").concat(a/4),fill:"none",stroke:"#e5e7eb",strokeWidth:"0.5"})})}),(0,s.jsx)("rect",{width:c,height:a,x:40,y:40,fill:"url(#grid)"}),r.line&&(0,s.jsxs)("g",{children:[(0,s.jsx)("line",{x1:40,y1:m(r.line.price),x2:40+c,y2:m(r.line.price),stroke:"#3b82f6",strokeWidth:"2",strokeDasharray:r.line.touches&&r.line.touches>=3?"0":"5,5",opacity:r.line.touches&&r.line.touches>=3?1:.5}),r.line.touches&&r.line.touches>=3&&d.length>0&&(0,s.jsx)(s.Fragment,{children:[0,Math.floor(d.length/2),d.length-1].map(e=>(0,s.jsx)("circle",{cx:p(e),cy:m(r.line.price),r:"4",fill:"#3b82f6"},e))})]}),d.map((e,t)=>{let n=p(t),l=m(Math.max(e.open,e.close)),i=m(Math.min(e.open,e.close)),o=e.close>e.open;return(0,s.jsxs)("g",{children:[(0,s.jsx)("line",{x1:n,y1:m(e.high),x2:n,y2:m(e.low),stroke:o?"#10b981":"#ef4444",strokeWidth:"1"}),(0,s.jsx)("rect",{x:n-.3*g,y:l,width:.6*g,height:i-l||1,fill:o?"#10b981":"#ef4444"})]},t)}),d.length>0&&(0,s.jsx)("g",{children:(0,s.jsx)("circle",{cx:p(d.length-1),cy:m(d[d.length-1].close),r:"5",fill:"#f59e0b",stroke:"white",strokeWidth:"2"})}),[0,.25,.5,.75,1].map(e=>{let t=u+x*(1-e);return(0,s.jsx)("text",{x:35,y:40+a*e,textAnchor:"end",fontSize:"10",fill:"#6b7280",children:t.toFixed(0)},e)})]}),(0,s.jsxs)("div",{className:"mt-2 text-xs text-gray-500 text-center",children:["trend"===r.type&&"上昇トレンド","range"===r.type&&"レンジ相場","transition"===r.type&&"転換期",r.line&&r.line.touches&&r.line.touches>=3&&" | ライン有効"]})]})}function a(e){let{params:t}=e,n=(0,o.useRouter)(),[a,d]=(0,l.useState)(null),[h,u]=(0,l.useState)(!0),[x,m]=(0,l.useState)("line"),[g,p]=(0,l.useState)({}),[f,b]=(0,l.useState)(!1),[j,y]=(0,l.useState)("");(0,l.useEffect)(()=>{!async function(){try{let e=(t instanceof Promise?await t:t).id;y(e);let n=await fetch("/api/problems/".concat(e)),s=await n.json();d(s),b((0,r.Dq)(e))}catch(e){console.error("Failed to load problem:",e)}finally{u(!1)}}()},[t]);let w=(e,t)=>{let n={...g,[e]:t};p(n);let s=["line","nowcast","scenario","timing","conclusion"],l=s.indexOf(x);if(l<s.length-1)m(s[l+1]);else{m("explanation");let e={timestamp:new Date().toISOString(),answers:{line:n.line||t,nowcast:n.nowcast||t,scenario:n.scenario||t,timing:n.timing||t,conclusion:n.conclusion||t}};j&&(0,r.rj)(j,e)}};if(h)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-gray-600",children:"読み込み中..."})});if(!a)return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-gray-600",children:"問題が見つかりません"})});let N=j?(0,r.BN)(j):null,v=(null==N?void 0:N.attemptCount)||0;return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,s.jsxs)("div",{className:"max-w-md mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)(i.default,{href:"/problems",className:"text-blue-500 hover:text-blue-600 text-sm",children:"← 問題一覧に戻る"}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:a.title||a.id}),(0,s.jsx)("button",{onClick:()=>{j&&((0,r.mN)(j),b(!f))},className:"text-2xl ".concat(f?"text-yellow-500":"text-gray-300"),children:"★"})]}),N&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["解いた回数: ",v,"回"]})]}),(0,s.jsx)("div",{className:"mb-6",children:a.chartImage?(0,s.jsx)("img",{src:a.chartImage,alt:"チャート",className:"w-full rounded-lg shadow-md"}):(0,s.jsx)(c,{data:a.chartData})}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:["line"===x&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:a.flow.line.question}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{onClick:()=>w("line","yes"),className:"w-full p-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Yes"}),(0,s.jsx)("button",{onClick:()=>w("line","no"),className:"w-full p-4 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"No"})]})]}),"nowcast"===x&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:a.flow.nowcast.question}),(0,s.jsx)("div",{className:"space-y-3",children:a.flow.nowcast.options.map(e=>(0,s.jsx)("button",{onClick:()=>w("nowcast",e),className:"w-full p-4 bg-gray-200 text-gray-900 rounded-lg hover:bg-gray-300 transition-colors",children:e},e))})]}),"scenario"===x&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:a.flow.scenario.question}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{onClick:()=>w("scenario","yes"),className:"w-full p-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Yes"}),(0,s.jsx)("button",{onClick:()=>w("scenario","no"),className:"w-full p-4 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"No"})]})]}),"timing"===x&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:a.flow.timing.question}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{onClick:()=>w("timing","yes"),className:"w-full p-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Yes"}),(0,s.jsx)("button",{onClick:()=>w("timing","no"),className:"w-full p-4 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"No"})]})]}),"conclusion"===x&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:a.flow.conclusion.question}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{onClick:()=>w("conclusion","entry"),className:"w-full p-4 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Entry"}),(0,s.jsx)("button",{onClick:()=>w("conclusion","skip"),className:"w-full p-4 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Skip"})]})]}),"explanation"===x&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"解説"}),(0,s.jsxs)("div",{className:"space-y-4 text-sm",children:[a.explanation.line&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-1",children:"ライン判断"}),(0,s.jsx)("p",{className:"text-gray-700",children:a.explanation.line})]}),a.explanation.nowcast&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-1",children:"ナウキャスト判断"}),(0,s.jsx)("p",{className:"text-gray-700",children:a.explanation.nowcast})]}),a.explanation.scenario&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-1",children:"シナリオ判断"}),(0,s.jsx)("p",{className:"text-gray-700",children:a.explanation.scenario})]}),a.explanation.timing&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-1",children:"タイミング判断"}),(0,s.jsx)("p",{className:"text-gray-700",children:a.explanation.timing})]}),a.explanation.conclusion&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold mb-1",children:"結論"}),(0,s.jsx)("p",{className:"text-gray-700",children:a.explanation.conclusion})]}),a.explanation.overall&&(0,s.jsxs)("div",{className:"pt-4 border-t",children:[(0,s.jsx)("h3",{className:"font-semibold mb-1",children:"全体の解説"}),(0,s.jsx)("p",{className:"text-gray-700",children:a.explanation.overall})]})]}),(0,s.jsx)("button",{onClick:()=>{n.push("/problems")},className:"w-full mt-6 p-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"次の問題へ"})]})]})]})})}},7795:function(e,t,n){"use strict";n.d(t,{BN:function(){return u},Dq:function(){return h},J7:function(){return r},h8:function(){return c},mN:function(){return d},rj:function(){return a},xC:function(){return i}});let s="yosuga-progress",l="1.0.0";function i(){try{let e=localStorage.getItem(s);if(!e)return null;let t=JSON.parse(e);return t.version,t}catch(e){return console.error("Failed to load progress:",e),null}}function o(e){try{e.version=l,localStorage.setItem(s,JSON.stringify(e))}catch(e){console.error("Failed to save progress:",e)}}function r(){return{version:l,problems:{},studyDays:[],favorites:[]}}function c(){localStorage.removeItem(s)}function a(e,t){let n=i()||r();n.problems[e]||(n.problems[e]={problemId:e,attemptCount:0,lastAttemptedAt:new Date().toISOString(),history:[]});let s=n.problems[e];s.attemptCount+=1,s.lastAttemptedAt=new Date().toISOString(),s.history.push(t),s.history.length>100&&(s.history=s.history.slice(-100)),o(n),function(e){let t=i()||r();t.studyDays.includes(e)||(t.studyDays.push(e),o(t))}(new Date().toISOString().split("T")[0])}function d(e){let t=i()||r(),n=t.favorites.indexOf(e);-1===n?t.favorites.push(e):t.favorites.splice(n,1),o(t)}function h(e){let t=i();return!!t&&t.favorites.includes(e)}function u(e){let t=i();return t&&t.problems[e]||null}},7648:function(e,t,n){"use strict";n.d(t,{default:function(){return l.a}});var s=n(2972),l=n.n(s)},9376:function(e,t,n){"use strict";var s=n(5475);n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=8818)}),_N_E=e.O()}]);